{%extends display.admin%}



{%block pageContent%}

  {{block('detailCards')}}

{%if dataTable%}

{{block('htmlTable')}}

{%else%}
{{block('htmlStartAddNew')}}
{%endif%}

{%endblock%}







{%block htmlTable%}
<table class="tbl1 v1 cbox fs12">
  <thead>
    <th colspan="2">{%trans "Last active tickets"%}</th>
    <th></th>
    <th></th>
    <th></th>
    <th></th>
    <th class="collapsing txtRa"><a href="{{url.here}}/ticket">{%trans "All Tickets"%}</a></th>
  </thead>
  <tbody>
{%for key, value in dataTable%}
    <tr>
      <td class="collapsing txtB"><a href="{{url.here}}/ticket/show?id={{value.id}}">{{value.title | slice(0, 40)}}</a></td>
      <td><a href="{{url.here}}/ticket/show?id={{value.id}}">{{value.content | slice(0, 70)}}</a>
{%if value.tag%}
        <div class="mT5 fs12">
{%for Tkey, Tvalue in value.tag%}
          <a class="badge" href="{{url.here}}/tag/">{{Tvalue}}</a>
{%endfor%}
        </div>
{%endif%}
      </td>
      <td class="collapsing">{%if value.status != 'awaiting'%}<i class="compact sf-spin-alt fc-green"></i>{%else%}<i class="compact sf-asterisk spiny fc-red"></i>{%endif%}</td>
      <td class="collapsing">{%if value.plus%}{{value.plus | fitNumber}} <i class="compact sf-chat-alt-fill"></i>{%else%}{%endif%}</td>
      <td class="collapsing"><span title='{%trans "Created on"%} {{value.datecreated | tdate("Y-m-d H:i:s")}}'>{{value.datecreated | sdate("year")}}</span></td>
      <td class="collapsing fs08">{%set myStatus = value.status%} {%trans myStatus%}</td>

      <td class="collapsing">
        <span class="txtB">{{value.displayname}}</span>
        <img src="{{value.avatar}}" class="avatar mLa10" src="{{value.displayname}}">
      </td>
    </tr>
{%endfor%}
  </tbody>
</table>


 <div class="cbox fs12 pB5">
  <h3>{%trans "Active tickets"%}</h3>
{%for key, value in dataTable%}
  <a class="msg f align-center" href="{{url.here}}/ticket/show?id={{value.id}}">
    <span class="cauto"><img src="{{value.avatar}}" class="avatar mRa10" src="{{value.displayname}}"></span>
    <span class="c2 s0 txtB pRa10">{{value.displayname}}</span>

{%if value.tag%}
    <span class="cauto s0 pRa10">
{%for Tkey, Tvalue in value.tag%}
      <span class="badge">{{Tvalue}}</span>
{%endfor%}
    </span>
{%endif%}

    <span class="cauto s txtB pRa10">{{value.title}}</span>
    <span class="c s0">{{value.content | slice(0, 70)}}</span>
    <span class="cauto pRa10">{%if value.status != 'awaiting'%}<i class="sf-spin-alt fc-green"></i>{%else%}<i class="sf-asterisk spiny fc-red"></i>{%endif%}</span>
    <span class="cauto pRa10">{{value.plus | fitNumber}} <i class="sf-chat-alt-fill"></i></span>
    <span class="cauto we80 s0 txtRa os" title='{{value.datecreated | tdate("Y-m-d H:i:s")}}'>{{value.datecreated | sdate("year")}}</span>
  </a>
{%endfor%}
 </div>
{%endblock%}



{%block htmlStartAddNew%}
<p class="fs14 msg success2 pTB20">{%trans "Hi!"%} <a href="{{url.here}}/ticket/add">{%trans "Open new ticket!"%}</a></p>
{%endblock%}





{%block detailCards%}

<div class="f mB10">
  <div class="c2 s12">
    <a class="dcard" href="{{url.here}}/ticket">
      <div class="statistic sm teal">
        <div class="label mB10"><i class="fs20 mRa5 sf-life-ring"></i> {%trans "Tickets"%}</div>
        <div class="value counter">{{dashboardDetail.tickets |fitNumber}}</div>
      </div>
    </a>
  </div>
  <div class="c2 s6">
    <a class="dcard" href="{{url.here}}/replies">
      <div class="statistic sm">
        <div class="label mB10"><i class="fs20 mRa5 sf-chat"></i> {%trans "Replies"%}</div>
        <div class="value">{{dashboardDetail.replies |fitNumber}}</div>
      </div>
    </a>
  </div>

  <div class="c2 s6">
    <a class="dcard" href="{{url.here}}/ticket?status=closed">
      <div class="statistic sm">
        <div class="label mB10"><i class="fs20 mRa5 sf-archive"></i> {%trans "Archived"%}</div>
        <div class="value">{{dashboardDetail.archived |fitNumber}}</div>
      </div>
    </a>
  </div>

  <div class="c3 s12">
    <a class="dcard" href="{{url.here}}/ticket?order=firstResponse">
      <div class="statistic sm">
        <div class="label mB10"><i class="fs20 mRa5 sf-clock-o"></i> {%trans "Avg. First Response"%}</div>
        <div class="value">{{dashboardDetail.avgfirst |fitNumber}} <small class="fs05">{%trans "Minute"%}</small></div>
      </div>
    </a>
  </div>

  <div class="c3 s12">
    <a class="dcard" href="{{url.here}}/ticket?order=avgArchiveTime">
      <div class="statistic sm">
        <div class="label mB10"><i class="fs20 mRa5 sf-calendar-check-o"></i> {%trans "Avg. Time to Archive"%}</div>
        <div class="value">{{dashboardDetail.avgarchive |fitNumber}} <small class="fs05">{%trans "Hours"%}</small></div>
      </div>
    </a>
  </div>

</div>
{%endblock%}

